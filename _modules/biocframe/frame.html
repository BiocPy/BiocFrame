<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.12.19 -->
        <title>biocframe.frame - BiocFrame 0.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">BiocFrame 0.7.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <span class="sidebar-brand-text">BiocFrame 0.7.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html"><code class="docutils literal notranslate"><span class="pre">BiocFrame</span></code> - Bioconductor-like data frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#when-to-use-biocframe">When to Use <code class="docutils literal notranslate"><span class="pre">BiocFrame</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#advantages-of-biocframe">Advantages of <code class="docutils literal notranslate"><span class="pre">BiocFrame</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#construction">Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#example-use-cases">Example Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#with-other-dataframe-libraries">With other <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#pandas">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#extracting-data">Extracting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#setting-data">Setting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#iterate-over-rows">Iterate over rows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#combining-objects">Combining objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html#empty-frames">Empty Frames</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/modules.html">Module Reference</a><input aria-label="Toggle navigation of Module Reference" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/biocframe.html">biocframe package</a><input aria-label="Toggle navigation of biocframe package" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/biocframe.io.html">biocframe.io package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributions &amp; Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for biocframe.frame</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="n">abc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">copy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">warnings</span><span class="w"> </span><span class="kn">import</span> <span class="n">warn</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">biocutils</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ut</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">polars</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Jayaram Kancherla, Aaron Lun, Kevin Yang&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;jkanche&quot;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;MIT&quot;</span>


<span class="c1">############################</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_guess_number_of_rows</span><span class="p">(</span>
    <span class="n">number_of_rows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">row_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">number_of_rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number_of_rows</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_height</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
    <span class="k">if</span> <span class="n">row_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_names</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_validate_rows</span><span class="p">(</span>
    <span class="n">number_of_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">row_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">incorrect_len_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">number_of_rows</span> <span class="o">!=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_height</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="n">incorrect_len_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">incorrect_len_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All columns in ``data`` must be the same length, these columns do not: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">incorrect_len_keys</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">row_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_names</span><span class="p">)</span> <span class="o">!=</span> <span class="n">number_of_rows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Length of `row_names` and `number_of_rows` do not match, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">row_names</span><span class="p">)</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">number_of_rows</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`row_names` cannot contain None values.&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_validate_columns</span><span class="p">(</span>
    <span class="n">column_names</span><span class="p">:</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">column_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mismatch between `column_names` and the keys of `data`.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">column_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of rows in `column_data` should be equal to the number of columns.&quot;</span><span class="p">)</span>


<span class="c1">############################</span>


<div class="viewcode-block" id="BiocFrameIter">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrameIter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">BiocFrameIter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An iterator to a :py:class:`~biocframe.BiocFrame.BiocFrame` object.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="BiocFrameIter.__init__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrameIter.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the iterator.</span>

<span class="sd">        Args:</span>
<span class="sd">            obj:</span>
<span class="sd">                Source object to iterate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bframe</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">=</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="BiocFrameIter.__iter__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrameIter.__iter__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrameIter</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="BiocFrameIter.__next__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrameIter.__next__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bframe</span><span class="p">):</span>
            <span class="n">iter_row_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bframe</span><span class="o">.</span><span class="n">row_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bframe</span><span class="o">.</span><span class="n">row_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="n">iter_slice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bframe</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">iter_row_index</span><span class="p">,</span> <span class="n">iter_slice</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">StopIteration</span></div>
</div>



<span class="c1">############################</span>


<div class="viewcode-block" id="BiocFrame">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">BiocFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`BiocFrame` is an alternative to :class:`~pandas.DataFrame`, with support for nested and flexible column types.</span>
<span class="sd">    Inspired by the ``DFrame`` class from Bioconductor&#39;s **S4Vectors** package. Any object may be used as a column,</span>
<span class="sd">    provided it has:</span>

<span class="sd">    - Some concept of &quot;height&quot;, as defined by :py:func:`~biocutils.get_height.get_height` from **BiocUtils**.</span>
<span class="sd">      This defaults to the length as defined by ``__len__``.</span>
<span class="sd">    - The ability to be sliced by integer indices, as implemented by :py:func:`~biocutils.subset.subset` from **BiocUtils**.</span>
<span class="sd">      This defaults to calling ``__getitem__``.</span>
<span class="sd">    - The ability to be combined with other objects, as implemented in :py:func:`~biocutils.combine.combine` from **BiocUtils**.</span>
<span class="sd">    - The ability to perform an assignment, as implemented in :py:func:`~biocutils.assign.assign` from **BiocUtils**.</span>

<span class="sd">    This allows ``BiocFrame`` to accept arbitrarily complex classes (such as nested ``BiocFrame`` instances) as columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BiocFrame.__init__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">NamedList</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">number_of_rows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">row_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">column_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">column_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">NamedList</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a ``BiocFrame`` object from columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            data:</span>
<span class="sd">                Dictionary of column names as `keys` and their values. All</span>
<span class="sd">                columns must have the same length. Defaults to an empty</span>
<span class="sd">                dictionary.</span>

<span class="sd">                Alternatively may provide a `Mapping` object, for example</span>
<span class="sd">                a :py:class:`~biocutils.NamedList` that can be coerced into</span>
<span class="sd">                a dictionary.</span>

<span class="sd">                Alternatively, a sequence of columns may be provided. In this case,</span>
<span class="sd">                ``column_names`` must be provided and must have the same length</span>
<span class="sd">                as the sequence.</span>

<span class="sd">            number_of_rows:</span>
<span class="sd">                Number of rows. If not specified, inferred from ``data``. This</span>
<span class="sd">                needs to be provided if ``data`` is empty and ``row_names`` are</span>
<span class="sd">                not present.</span>

<span class="sd">            row_names:</span>
<span class="sd">                Row names. This should not contain missing strings.</span>

<span class="sd">            column_names:</span>
<span class="sd">                Column names. If not provided, inferred from the ``data``.</span>
<span class="sd">                This may be in a different order than the keys of ``data``.</span>
<span class="sd">                This should not contain missing strings.</span>

<span class="sd">            column_data:</span>
<span class="sd">                Metadata about columns. Must have the same number of rows as</span>
<span class="sd">                the length of ``column_names``. Defaults to None.</span>

<span class="sd">            metadata:</span>
<span class="sd">                Additional metadata. Defaults to an empty dictionary.</span>

<span class="sd">            _validate:</span>
<span class="sd">                Internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">NamedList</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
            <span class="c1"># making sure all column values are lists</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="c1"># if its a scalar, make a list else corce to list</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">column_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`column_names` must be provided if `data` is a sequence.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of `data` and `column_names` must match.&quot;</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">if</span> <span class="n">row_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row_names</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">):</span>
            <span class="n">row_names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">(</span><span class="n">row_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span> <span class="o">=</span> <span class="n">row_names</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="n">_guess_number_of_rows</span><span class="p">(</span>
                <span class="n">number_of_rows</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">column_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span> <span class="o">=</span> <span class="n">column_names</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">)</span> <span class="k">else</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">metadata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span> <span class="o">=</span> <span class="n">column_data</span>

        <span class="k">if</span> <span class="n">_validate</span><span class="p">:</span>
            <span class="n">_validate_rows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="p">)</span>
            <span class="n">_validate_columns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_define_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">in_place</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>

<div class="viewcode-block" id="BiocFrame.__eq__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__eq__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the current object is equal to another.</span>

<span class="sd">        Args:</span>
<span class="sd">            other:</span>
<span class="sd">                Object to compare with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the objects are equal, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BiocFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">row_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
            <span class="n">d1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="n">d2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">d1</span> <span class="o">!=</span> <span class="n">d2</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="c1"># Fallback for other array-like objects (e.g. pandas Series)</span>
                    <span class="c1"># where bool(d1 == d2) is ambiguous.</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">):</span>
                        <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_data</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">column_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span></div>


    <span class="c1">#################################</span>
    <span class="c1">######&gt;&gt; Shape and stuff &lt;&lt;######</span>
    <span class="c1">#################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            Tuple containing the number of rows and columns in this ``BiocFrame``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_rows</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">))</span>

<div class="viewcode-block" id="BiocFrame.__len__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__len__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            Number of rows.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the object is empty.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the object has no rows, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>

<div class="viewcode-block" id="BiocFrame.is_empty">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.is_empty">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the object is empty.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the object has no rows, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="BiocFrame.__iter__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__iter__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrameIter</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over rows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BiocFrameIter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.__contains__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__contains__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a column exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:</span>
<span class="sd">                Name of the column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the column exists, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_column</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~shape`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1">##########################</span>
    <span class="c1">######&gt;&gt; Printing &lt;&lt;######</span>
    <span class="c1">##########################</span>

<div class="viewcode-block" id="BiocFrame.__repr__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__repr__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            A string representation of this ``BiocFrame``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;BiocFrame(data=&quot;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">print_truncated_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;, number_of_rows=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;, row_names=&quot;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">print_truncated_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;, column_names=&quot;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">print_truncated_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># TODO: fix potential recursion here.</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;, column_data=&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;, metadata=&quot;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">print_truncated_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
        <span class="k">return</span> <span class="n">output</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            A pretty-printed string containing the contents of this ``BiocFrame``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;BiocFrame with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> row</span><span class="si">{</span><span class="s1">&#39;s&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> column</span><span class="si">{</span><span class="s1">&#39;s&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">nr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">added_table</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">nr</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">nr</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">)</span>
                <span class="n">insert_ellipsis</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nr</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nr</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">insert_ellipsis</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">raw_floating</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">create_floating_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">insert_ellipsis</span><span class="p">:</span>
                <span class="n">raw_floating</span> <span class="o">=</span> <span class="n">raw_floating</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">raw_floating</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
            <span class="n">floating</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">raw_floating</span>

            <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="n">showed</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_as_cell</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
                <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">print_type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">]</span>
                <span class="n">showed</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">truncate_strings</span><span class="p">(</span><span class="n">showed</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
                <span class="k">if</span> <span class="n">insert_ellipsis</span><span class="p">:</span>
                    <span class="n">showed</span> <span class="o">=</span> <span class="n">showed</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">showed</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
                <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="n">showed</span><span class="p">)</span>

            <span class="n">output</span> <span class="o">+=</span> <span class="n">ut</span><span class="o">.</span><span class="n">print_wrapped_table</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">floating_names</span><span class="o">=</span><span class="n">floating</span><span class="p">)</span>
            <span class="n">added_table</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">footer</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">footer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;column_data(&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="o">+</span> <span class="s2">&quot;): &quot;</span>
                <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">print_truncated_list</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">column_data</span><span class="o">.</span><span class="n">column_names</span><span class="p">,</span>
                    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="n">include_brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">):</span>
            <span class="n">footer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;metadata(&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;): &quot;</span>
                <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">print_truncated_list</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                    <span class="n">include_brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">footer</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">added_table</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">------</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">footer</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span>

    <span class="c1">###########################</span>
    <span class="c1">######&gt;&gt; Row names &lt;&lt;######</span>
    <span class="c1">###########################</span>

<div class="viewcode-block" id="BiocFrame.get_row_names">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_row_names">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_row_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get row names.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of row names, or None if no row names are available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span></div>


<div class="viewcode-block" id="BiocFrame.set_row_names">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.set_row_names">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_row_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new row names.</span>

<span class="sd">        Args:</span>
<span class="sd">            names:</span>
<span class="sd">                List of strings. This should have length equal to the</span>
<span class="sd">                number of rows in the current ``BiocFrame``.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the ``BiocFrame`` object in place.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Length of `names` does not match the number of rows, need to be &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> but provided </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`row_names` cannot contain None values.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">):</span>
                <span class="n">names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_output</span><span class="p">(</span><span class="n">in_place</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">_row_names</span> <span class="o">=</span> <span class="n">names</span>
        <span class="k">return</span> <span class="n">output</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">row_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_row_names`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_row_names</span><span class="p">()</span>

    <span class="nd">@row_names</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">row_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~set_row_names` with ``in_place = True``.</span>

<span class="sd">        As this mutates the original object, a warning is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Setting property &#39;row_names&#39; is an in-place operation, use &#39;set_row_names&#39; instead&quot;</span><span class="p">,</span>
            <span class="ne">UserWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_row_names</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rownames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_row_names`, provided for back-compatibility.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_row_names</span><span class="p">()</span>

    <span class="nd">@rownames</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rownames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~set_row_names` with ``in_place = True``, provided for back-compaibility only.</span>

<span class="sd">        As this mutates the original object, a warning is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_row_names</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">######################</span>
    <span class="c1">######&gt;&gt; Data &lt;&lt;######</span>
    <span class="c1">######################</span>

<div class="viewcode-block" id="BiocFrame.get_data">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the underlying data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of columns and their values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span></div>


<div class="viewcode-block" id="BiocFrame.to_dict">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.to_dict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:meth:`~get_data`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of columns and their values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span></div>


<div class="viewcode-block" id="BiocFrame.to_NamedList">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.to_NamedList">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_NamedList</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ut</span><span class="o">.</span><span class="n">NamedList</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the ``BiocFrame`` to a :py:class:`~biocutils.NamedList`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ``NamedList`` containing the columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ut</span><span class="o">.</span><span class="n">NamedList</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_data`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

    <span class="c1">##############################</span>
    <span class="c1">######&gt;&gt; Column names &lt;&lt;######</span>
    <span class="c1">##############################</span>

<div class="viewcode-block" id="BiocFrame.get_column_names">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_column_names">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get column names.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of column names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span></div>


<div class="viewcode-block" id="BiocFrame.get_columns">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all columns as a list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list containing the data for each column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">]</span></div>


<div class="viewcode-block" id="BiocFrame.set_column_names">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.set_column_names">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new column names.</span>

<span class="sd">        Args:</span>
<span class="sd">            names:</span>
<span class="sd">                List of unique strings, of length equal to the number of</span>
<span class="sd">                columns in this ``BiocFrame``.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the ``BiocFrame`` object in place.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provided `names` does not match number of columns.&quot;</span><span class="p">)</span>

        <span class="n">new_names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">()</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Column names cannot contain None values.&quot;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">new_data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Detected duplicate column name &#39;&quot;</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">&quot;&#39;.&quot;</span><span class="p">)</span>
            <span class="n">new_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">new_data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_output</span><span class="p">(</span><span class="n">in_place</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">_column_names</span> <span class="o">=</span> <span class="n">new_names</span>
        <span class="n">output</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">new_data</span>
        <span class="k">return</span> <span class="n">output</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_column_names`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()</span>

    <span class="nd">@column_names</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~set_column_names` with ``in_place = True``.</span>

<span class="sd">        As this mutates the original object, a warning is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Setting property &#39;column_names&#39; is an in-place operation, use &#39;set_column_names&#39; instead&quot;</span><span class="p">,</span>
            <span class="ne">UserWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_column_names</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_column_names`, provided for back-compatibility only.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()</span>

    <span class="nd">@colnames</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~set_column_names` with ``in_place = True``, provided for back-compatibility only.</span>

<span class="sd">        As this mutates the original object, a warning is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_column_names</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">##########################</span>
    <span class="c1">######&gt;&gt; Metadata &lt;&lt;######</span>
    <span class="c1">##########################</span>

<div class="viewcode-block" id="BiocFrame.get_column_data">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_column_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">with_names</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get column data.</span>

<span class="sd">        Args:</span>
<span class="sd">            with_names:</span>
<span class="sd">                Whether to set the column names of this ``BiocFrame`` as</span>
<span class="sd">                the row names of the column data ``BiocFrame``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The annotations for each column. This may be None if no annotation</span>
<span class="sd">            is present, or is a ``BiocFrame`` where each row corresponds to a</span>
<span class="sd">            column and contains that column&#39;s metadata.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span>
        <span class="k">if</span> <span class="n">with_names</span> <span class="ow">and</span> <span class="n">output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">set_row_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="BiocFrame.set_column_data">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.set_column_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new column data.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_data:</span>
<span class="sd">                New column data. This should either be a ``BiocFrame`` with the</span>
<span class="sd">                number of rows equal to the number of columns in the current object,</span>
<span class="sd">                or None to remove existing column data.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the ``BiocFrame`` object in place.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of rows in `column_data` should be equal to the number of columns.&quot;</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_output</span><span class="p">(</span><span class="n">in_place</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">_column_data</span> <span class="o">=</span> <span class="n">column_data</span>
        <span class="k">return</span> <span class="n">output</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_column_data`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">()</span>

    <span class="nd">@column_data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~set_column_data` with ``in_place = True``.</span>

<span class="sd">        As this mutates the original object, a warning is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Setting property &#39;column_data&#39; is an in-place operation, use &#39;set_column_data&#39; instead&quot;</span><span class="p">,</span>
            <span class="ne">UserWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_column_data</span><span class="p">(</span><span class="n">column_data</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="BiocFrame.get_metadata">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_metadata">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the metadata.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of metadata for this object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span></div>


<div class="viewcode-block" id="BiocFrame.set_metadata">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.set_metadata">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new metadata.</span>

<span class="sd">        Args:</span>
<span class="sd">            metadata:</span>
<span class="sd">                New metadata for this object.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the ``BiocFrame`` object in place.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`metadata` must be a dictionary, provided </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_output</span><span class="p">(</span><span class="n">in_place</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata</span>
        <span class="k">return</span> <span class="n">output</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_metadata`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>

    <span class="nd">@metadata</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~set_metadata` with ``in_place = True``.</span>

<span class="sd">        As this mutates the original object, a warning is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Setting property &#39;metadata&#39; is an in-place operation, use &#39;set_metadata&#39; instead&quot;</span><span class="p">,</span>
            <span class="ne">UserWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">################################</span>
    <span class="c1">######&gt;&gt; Single getters &lt;&lt;######</span>
    <span class="c1">################################</span>

<div class="viewcode-block" id="BiocFrame.has_column">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.has_column">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether a column with the specified ``name`` exists in this object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:</span>
<span class="sd">                Name of the column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the column exists, Otherwise False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span></div>


<div class="viewcode-block" id="BiocFrame.get_column">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_column">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the contents of the specified column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column:</span>
<span class="sd">                Name of the column, which must exist in :py:attr:`~get_column_names`.</span>

<span class="sd">                Alternatively, the integer index of the column of interest.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The contents of the specified column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Index cannot be negative.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">column</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2"> is out of range for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)</span><span class="si">}</span><span class="s2"> columns.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">[</span><span class="n">column</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column: </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;column&#39; must be a string or integer, provided &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">column</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.column">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.column">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:meth:`~get_column`, provided for back-compatibility only.&quot;&quot;&quot;</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Method &#39;column&#39; is deprecated, use &#39;get_column&#39; instead&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.has_row">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.has_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether a row with the specified ``name`` exists in this object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:</span>
<span class="sd">                Name of the row.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the row exists, Otherwise False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No row names are defined&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span></div>


<div class="viewcode-block" id="BiocFrame.get_row">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a specified row.</span>

<span class="sd">        Args:</span>
<span class="sd">            row:</span>
<span class="sd">                Integer index of the row to access.</span>

<span class="sd">                If row names are available (see :py:attr:`~get_row_names`), a</span>
<span class="sd">                string may be supplied instead. The first occurrence of the</span>
<span class="sd">                string in the row names is used.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary where the keys are column names and the values are</span>
<span class="sd">            the contents of the columns at the specified ``row``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No row names present to find row &#39;&quot;</span> <span class="o">+</span> <span class="n">row</span> <span class="o">+</span> <span class="s2">&quot;&#39;.&quot;</span><span class="p">)</span>

            <span class="n">row_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find row &#39;&quot;</span> <span class="o">+</span> <span class="n">row</span> <span class="o">+</span> <span class="s2">&quot;&#39;.&quot;</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">row_idx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># must be an int</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>  <span class="c1"># incase its a numpy int</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`row` must be either an integer index or row name.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Row index cannot be negative.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row index </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2"> is out of range for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows.&quot;</span><span class="p">)</span>

        <span class="n">collected</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">:</span>
            <span class="n">collected</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">row</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">collected</span></div>


<div class="viewcode-block" id="BiocFrame.row">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_row`, provided for back-compatibility only.&quot;&quot;&quot;</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Method &#39;row&#39; is deprecated, use &#39;get_row&#39; instead&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_row</span><span class="p">(</span><span class="n">row</span><span class="p">)</span></div>


    <span class="c1">#########################</span>
    <span class="c1">######&gt;&gt; Slicers &lt;&lt;######</span>
    <span class="c1">#########################</span>

<div class="viewcode-block" id="BiocFrame.head">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.head">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first `n` rows.</span>

<span class="sd">        Args:</span>
<span class="sd">            n:</span>
<span class="sd">                Number of rows to return.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ``BiocFrame`` object with the first `n` rows.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n must be non-negative.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span></div>


<div class="viewcode-block" id="BiocFrame.tail">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.tail">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last `n` rows.</span>

<span class="sd">        Args:</span>
<span class="sd">            n:</span>
<span class="sd">                Number of rows to return.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ``BiocFrame`` object with the last `n` rows.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n must be non-negative.&quot;</span><span class="p">)</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">rows</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">rows</span>

        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">rows</span> <span class="o">-</span> <span class="n">n</span> <span class="p">:</span> <span class="n">rows</span><span class="p">,</span> <span class="p">:]</span></div>


<div class="viewcode-block" id="BiocFrame.get_slice">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.get_slice">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_slice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rows</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">],</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Slice ``BiocFrame`` along the rows and/or columns, based on their indices or names.</span>

<span class="sd">        Args:</span>
<span class="sd">            rows:</span>
<span class="sd">                Rows to be extracted. This may be an integer, boolean, string,</span>
<span class="sd">                or any sequence thereof, as supported by</span>
<span class="sd">                :py:meth:`~biocutils.normalize_subscript.normalize_subscript`.</span>
<span class="sd">                Scalars are treated as length-1 sequences.</span>

<span class="sd">                Strings may only be used if row names are available (see</span>
<span class="sd">                :py:attr:`~get_row_names`). The first occurrence of each string</span>
<span class="sd">                in the row names is used for extraction.</span>

<span class="sd">            columns:</span>
<span class="sd">                Columns to be extracted. This may be an integer, boolean,</span>
<span class="sd">                string, or any sequence thereof, as supported by</span>
<span class="sd">                :py:meth:`~biocutils.normalize_subscript.normalize_subscript`.</span>
<span class="sd">                Scalars are treated as length-1 sequences.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ``BiocFrame`` with the specified rows and columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_column_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">and</span> <span class="n">columns</span> <span class="o">==</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">new_column_indices</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">normalize_subscript</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_column_names</span><span class="p">),</span> <span class="n">new_column_names</span><span class="p">)</span>
            <span class="n">new_column_names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset_sequence</span><span class="p">(</span><span class="n">new_column_names</span><span class="p">,</span> <span class="n">new_column_indices</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_column_indices</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">new_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">new_column_names</span><span class="p">:</span>
            <span class="n">new_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="n">new_row_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span>
        <span class="n">new_number_of_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rows</span> <span class="o">==</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">new_row_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_names</span>
            <span class="n">new_row_indices</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">normalize_subscript</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_row_names</span><span class="p">)</span>

            <span class="n">new_number_of_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row_indices</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">new_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_row_indices</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_row_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_row_names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset_sequence</span><span class="p">(</span><span class="n">new_row_names</span><span class="p">,</span> <span class="n">new_row_indices</span><span class="p">)</span>

        <span class="n">column_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span>
        <span class="k">if</span> <span class="n">column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">columns</span> <span class="o">!=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
                <span class="n">column_data</span> <span class="o">=</span> <span class="n">column_data</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">new_column_indices</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>

        <span class="n">current_class_const</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">current_class_const</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span>
            <span class="n">number_of_rows</span><span class="o">=</span><span class="n">new_number_of_rows</span><span class="p">,</span>
            <span class="n">row_names</span><span class="o">=</span><span class="n">new_row_names</span><span class="p">,</span>
            <span class="n">column_names</span><span class="o">=</span><span class="n">new_column_names</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span>
            <span class="n">column_data</span><span class="o">=</span><span class="n">column_data</span><span class="p">,</span>
            <span class="n">_validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.slice">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.slice">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">slice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">]],</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~__getitem__`, for back-compatibility.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="BiocFrame.__getitem__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__getitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">],</span> <span class="o">...</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:attr:`~get_column` and :py:attr:`~get_slice` to obtain a slice of a ``BiocFrame`` or any</span>
<span class="sd">        of its columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            args:</span>
<span class="sd">                A sequence or a scalar integer or string, specifying the</span>
<span class="sd">                columns to retain based on their names or indices.</span>

<span class="sd">                Alternatively a tuple of length 1. The first entry specifies</span>
<span class="sd">                the rows to retain based on their names or indices.</span>

<span class="sd">                Alternatively a tuple of length 2. The first entry specifies</span>
<span class="sd">                the rows to retain, while the second entry specifies the</span>
<span class="sd">                columns to retain, based on their names or indices.</span>

<span class="sd">        Returns:</span>
<span class="sd">            If ``args`` is a scalar, the specified column is returned. This is</span>
<span class="sd">            achieved internally by calling :py:attr:`~get_column`.</span>

<span class="sd">            If ``args`` is a sequence, a new ``BiocFrame`` is returned</span>
<span class="sd">            containing only the specified columns. This is achieved by just</span>
<span class="sd">            calling :py:attr:`~get_slice` with no row slicing.</span>

<span class="sd">            If ``args`` is a tuple of length 1, a new ``BiocFrame`` is returned</span>
<span class="sd">            containing the specified rows. This is achieved by just calling</span>
<span class="sd">            :py:attr:`~get_slice` with no column slicing.</span>

<span class="sd">            If ``args`` is a tuple of length 2, a new ``BiocFrame`` is returned</span>
<span class="sd">            containing the specified rows and columns. This is achieved by just</span>
<span class="sd">            calling :py:attr:`~get_slice` with the specified arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one slicing argument must be provided.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slice</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slice</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`BiocFrame` only supports 2-dimensional slicing.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slice</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">args</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.__setitem__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__setitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">],</span> <span class="o">...</span><span class="p">]],</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:attr:`~set_column` and :py:attr:`~set_slice` to modify a slice of a ``BiocFrame`` or any</span>
<span class="sd">        of its columns. As this modified the original object in place, a warning is raise.</span>

<span class="sd">        If ``args`` is a string, it is assumed to be a column name and</span>
<span class="sd">        ``value`` is expected to be the column contents; these are passed onto</span>
<span class="sd">        :py:attr:`~set_column` with ``in_place = True``.</span>

<span class="sd">        If ``args`` is a tuple, it is assumed to contain row and column indices.</span>
<span class="sd">        ``value`` is expected to be a ``BiocFrame`` containing replacement values.</span>
<span class="sd">        These are passed to :py:attr:`~set_slice` with ``in_place = True``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;This method performs an in-place operation, use &#39;set_slice&#39; instead&quot;</span><span class="p">,</span>
                <span class="ne">UserWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_slice</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;This method performs an in-place operation, use &#39;set_column&#39; instead&quot;</span><span class="p">,</span>
                <span class="ne">UserWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.set_slice">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.set_slice">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_slice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rows</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">],</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">],</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">,</span>
        <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace a slice of the ``BiocFrame`` given the row and columns of the slice.</span>

<span class="sd">        Args:</span>
<span class="sd">            rows:</span>
<span class="sd">                Rows to be replaced. This may be any sequence of strings,</span>
<span class="sd">                integers, or booleans (or mixture thereof), as supported by</span>
<span class="sd">                :py:meth:`~biocutils.normalize_subscript.normalize_subscript`.</span>
<span class="sd">                Scalars are treated as length-1 sequences.</span>

<span class="sd">                Strings may only be used if row names are available (see</span>
<span class="sd">                :py:attr:`~get_row_names`). The first occurrence of each string</span>
<span class="sd">                in the row names is used for extraction.</span>

<span class="sd">            columns:</span>
<span class="sd">                Columns to be replaced. This may be any sequence of strings,</span>
<span class="sd">                integers, or booleans (or mixture thereof), as supported by</span>
<span class="sd">                :py:meth:`~biocutils.normalize_subscript.normalize_subscript`.</span>
<span class="sd">                Scalars are treated as length-1 sequences.</span>

<span class="sd">            value:</span>
<span class="sd">                A ``BiocFrame`` containing replacement values. Each row</span>
<span class="sd">                corresponds to a row in ``rows``, while each column corresponds</span>
<span class="sd">                to a column in ``columns``. Note that the replacement is based</span>
<span class="sd">                on position, so row and column names in ``value`` are ignored.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the ``BiocFrame`` object in place.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_output</span><span class="p">(</span><span class="n">in_place</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_place</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">row_idx</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">normalize_subscript</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">_row_names</span><span class="p">)</span>

        <span class="n">col_idx</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">normalize_subscript</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">col_idx</span><span class="p">):</span>
            <span class="n">nm</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">nm</span><span class="p">]</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
                <span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">nm</span><span class="p">],</span>
                <span class="n">row_idx</span><span class="p">,</span>
                <span class="n">replacement</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">_column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span></div>


    <span class="c1">##############################</span>
    <span class="c1">######&gt;&gt; Item setters &lt;&lt;######</span>
    <span class="c1">##############################</span>

<div class="viewcode-block" id="BiocFrame.__delitem__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__delitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~remove_column` with ``in_place = True``.</span>

<span class="sd">        As this mutates the original object, a warning is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;This method perform an in-place operation, use &#39;remove_column&#39; instead&quot;</span><span class="p">,</span>
            <span class="ne">UserWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.set_column">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.set_column">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modify an existing column or add a new column. This is a convenience wrapper around :py:attr:`~set_columns`.</span>

<span class="sd">        Args:</span>
<span class="sd">            column:</span>
<span class="sd">                Name of an existing or new column. Alternatively, an index</span>
<span class="sd">                specifying the position of an existing column.</span>

<span class="sd">            value:</span>
<span class="sd">                Value of the new column. This should have the same height</span>
<span class="sd">                as the number of rows in the current object.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the object in place.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_columns</span><span class="p">({</span><span class="n">column</span><span class="p">:</span> <span class="n">value</span><span class="p">},</span> <span class="n">in_place</span><span class="o">=</span><span class="n">in_place</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.set_columns">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.set_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modify existing columns or add new columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns:</span>
<span class="sd">                Contents of the columns to set. Keys may be strings containing</span>
<span class="sd">                new or existing column names, or integers containing the position</span>
<span class="sd">                of the column. Values should be the contents of each column.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the object in place. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_output</span><span class="p">(</span><span class="n">in_place</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_place</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="n">is_colnames_copied</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">previous</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">output</span><span class="o">.</span><span class="n">_number_of_rows</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_height</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">_row_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_row_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">output</span><span class="o">.</span><span class="n">_number_of_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">_row_names</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_height</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Length of `value`, does not match the number of the rows,&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;need to be </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> but provided </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">column</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">in_place</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_colnames_copied</span><span class="p">:</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">_column_names</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)</span>
                    <span class="n">is_colnames_copied</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

            <span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">_column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">newly_added</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)</span> <span class="o">-</span> <span class="n">previous</span>
            <span class="k">if</span> <span class="n">newly_added</span><span class="p">:</span>
                <span class="n">extras</span> <span class="o">=</span> <span class="n">BiocFrame</span><span class="p">({},</span> <span class="n">number_of_rows</span><span class="o">=</span><span class="n">newly_added</span><span class="p">)</span>
                <span class="n">output</span><span class="o">.</span><span class="n">_column_data</span> <span class="o">=</span> <span class="n">relaxed_combine_rows</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_column_data</span><span class="p">,</span> <span class="n">extras</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="BiocFrame.remove_column">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.remove_column">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a column. This is a convenience wrapper around :py:attr:`~remove_columns`.</span>

<span class="sd">        Args:</span>
<span class="sd">            column:</span>
<span class="sd">                Name or positional index of the column to remove.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the object in place. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">([</span><span class="n">column</span><span class="p">],</span> <span class="n">in_place</span><span class="o">=</span><span class="n">in_place</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.remove_columns">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.remove_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove any number of existing columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns:</span>
<span class="sd">                Column identifiers to remove. Must be either:</span>
<span class="sd">                - A sequence of strings matching column names</span>
<span class="sd">                - A sequence of integer indices</span>
<span class="sd">                - A slice object</span>
<span class="sd">            in_place: Whether to modify the object in place. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BiocFrame: A modified ``BiocFrame`` object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If columns contains mixed types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_output</span><span class="p">(</span><span class="n">in_place</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_place</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">)))</span>
            <span class="n">killset</span> <span class="o">=</span> <span class="p">{</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Check for homogeneous types</span>
            <span class="n">types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;columns must contain all strings or all integers&quot;</span><span class="p">)</span>

            <span class="n">killset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">name</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column index </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> is out of range.&quot;</span><span class="p">)</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>

                <span class="k">del</span> <span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="n">killset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">keep</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">killset</span><span class="p">:</span>
                <span class="n">keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="n">output</span><span class="o">.</span><span class="n">_column_names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset_sequence</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_column_names</span><span class="p">,</span> <span class="n">keep</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">_column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">_column_data</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">_column_data</span><span class="p">[</span><span class="n">keep</span><span class="p">,</span> <span class="p">:]</span>

        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="BiocFrame.remove_row">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.remove_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a row. This is a convenience wrapper around :py:attr:`~remove_rows`.</span>

<span class="sd">        Args:</span>
<span class="sd">            row:</span>
<span class="sd">                Name or positional index of the row to remove.</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the object in place. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_rows</span><span class="p">([</span><span class="n">row</span><span class="p">],</span> <span class="n">in_place</span><span class="o">=</span><span class="n">in_place</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.remove_rows">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.remove_rows">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="nb">slice</span><span class="p">],</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove any number of existing rows.</span>

<span class="sd">        Args:</span>
<span class="sd">            rows:</span>
<span class="sd">                Row identifiers to remove. Must be either:</span>
<span class="sd">                - A sequence of strings matching row names</span>
<span class="sd">                - A sequence of integer indices</span>
<span class="sd">                - A slice object</span>

<span class="sd">            in_place:</span>
<span class="sd">                Whether to modify the object in place. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A modified ``BiocFrame`` object, either as a copy of the original</span>
<span class="sd">            or as a reference to the (in-place-modified) original.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If rows contain mixed types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_define_output</span><span class="p">(</span><span class="n">in_place</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_place</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">_row_names</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">_row_names</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">_row_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># raise ValueError(&quot;Cannot remove rows when row names are not defined.&quot;)</span>
            <span class="n">_row_names</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">rows</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_row_names</span><span class="p">)))</span>
            <span class="n">killset</span> <span class="o">=</span> <span class="p">{</span><span class="n">_row_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Check for homogeneous types</span>
            <span class="n">types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;rows must contain all strings or all integers&quot;</span><span class="p">)</span>

            <span class="n">killset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">name</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_row_names</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row index </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> is out of range.&quot;</span><span class="p">)</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">_row_names</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_row_names</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>
                <span class="n">killset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">keep</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_row_names</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">row</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">killset</span><span class="p">:</span>
                <span class="n">keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset_sequence</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">keep</span><span class="p">)</span>

        <span class="n">output</span><span class="o">.</span><span class="n">_row_names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset_sequence</span><span class="p">(</span><span class="n">_row_names</span><span class="p">,</span> <span class="n">keep</span><span class="p">)</span>

        <span class="n">output</span><span class="o">.</span><span class="n">_number_of_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="n">_guess_number_of_rows</span><span class="p">(</span>
                <span class="n">number_of_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span>
                <span class="n">row_names</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">_row_names</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span></div>


    <span class="c1">#########################</span>
    <span class="c1">######&gt;&gt; Copying &lt;&lt;######</span>
    <span class="c1">#########################</span>

<div class="viewcode-block" id="BiocFrame.__deepcopy__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__deepcopy__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            A deep copy of the current ``BiocFrame``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>

        <span class="n">_colnames_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">)</span>
        <span class="n">_num_rows_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_rows</span><span class="p">)</span>
        <span class="n">_rownames_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_names</span><span class="p">)</span>
        <span class="n">_metadata_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="n">_column_data_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># copy dictionary first</span>
        <span class="n">_data_copy</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">_colnames_copy</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_data_copy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot `deepcopy` column &#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&#39;, full error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="n">current_class_const</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">current_class_const</span><span class="p">(</span>
            <span class="n">_data_copy</span><span class="p">,</span>
            <span class="n">number_of_rows</span><span class="o">=</span><span class="n">_num_rows_copy</span><span class="p">,</span>
            <span class="n">row_names</span><span class="o">=</span><span class="n">_rownames_copy</span><span class="p">,</span>
            <span class="n">column_names</span><span class="o">=</span><span class="n">_colnames_copy</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">_metadata_copy</span><span class="p">,</span>
            <span class="n">column_data</span><span class="o">=</span><span class="n">_column_data_copy</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.__copy__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__copy__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            A shallow copy of the current ``BiocFrame``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_class_const</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new_instance</span> <span class="o">=</span> <span class="n">current_class_const</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span>
            <span class="n">number_of_rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_rows</span><span class="p">,</span>
            <span class="n">row_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="p">,</span>
            <span class="n">column_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span>
            <span class="n">column_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_column_data</span><span class="p">,</span>
            <span class="n">_validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">new_instance</span></div>


<div class="viewcode-block" id="BiocFrame.copy">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.copy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:meth:`~__copy__`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span></div>


    <span class="c1">##########################</span>
    <span class="c1">######&gt;&gt; split by &lt;&lt;######</span>
    <span class="c1">##########################</span>

<div class="viewcode-block" id="BiocFrame.split">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.split">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">only_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split the object by a column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_name:</span>
<span class="sd">                Name of the column to split by.</span>

<span class="sd">            only_indices:</span>
<span class="sd">                Whether to only return indices.</span>
<span class="sd">                Defaults to False</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary of biocframe objects, with names representing the</span>
<span class="sd">            group and the value the sliced frames.</span>

<span class="sd">            if ``only_indices`` is True, the values contain the row indices</span>
<span class="sd">            that map to the same group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2">&#39; is not a valid column name.&quot;</span><span class="p">)</span>

        <span class="n">_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>

        <span class="n">_grps</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="n">_key</span> <span class="o">=</span> <span class="n">_column</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_grps</span><span class="p">:</span>
                <span class="n">_grps</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">_grps</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">only_indices</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_grps</span>

        <span class="n">_sliced_grps</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">_grps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">_sliced_grps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">v</span><span class="p">,]</span>

        <span class="k">return</span> <span class="n">_sliced_grps</span></div>


    <span class="c1">################################</span>
    <span class="c1">######&gt;&gt; pandas interop &lt;&lt;######</span>
    <span class="c1">################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias to :py:attr:`~get_row_names`, provided for compatibility with **pandas**.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_row_names</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :py:attr:`~get_column_names`, provided for compatibility with **pandas**.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()</span>

<div class="viewcode-block" id="BiocFrame.to_pandas">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.to_pandas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the ``BiocFrame`` into a :py:class:`~pandas.DataFrame` object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A :py:class:`~pandas.DataFrame` object. Column names of the resulting</span>
<span class="sd">            dataframe may be different is the `BiocFrame` is nested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">_data_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">as_type</span><span class="o">=</span><span class="s2">&quot;dict&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">_data_copy</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{},</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_rows</span><span class="p">))</span></div>


<div class="viewcode-block" id="BiocFrame.from_pandas">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.from_pandas">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pandas</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ``BiocFrame`` from a :py:class:`~pandas.DataFrame` object.</span>

<span class="sd">        Args:</span>
<span class="sd">            input:</span>
<span class="sd">                Input data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ``BiocFrame`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`data` is not a pandas `DataFrame` object.&quot;</span><span class="p">)</span>

        <span class="n">rdata</span> <span class="o">=</span> <span class="nb">input</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;list&quot;</span><span class="p">)</span>
        <span class="n">rindex</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">input</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rindex</span> <span class="o">=</span> <span class="nb">input</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rdata</span><span class="p">,</span> <span class="n">row_names</span><span class="o">=</span><span class="n">rindex</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="nb">input</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span></div>


    <span class="c1">################################</span>
    <span class="c1">######&gt;&gt; polars interop &lt;&lt;######</span>
    <span class="c1">################################</span>

<div class="viewcode-block" id="BiocFrame.from_polars">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.from_polars">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_polars</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="s2">&quot;polars.DataFrame&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ``BiocFrame`` from a :py:class:`~polars.DataFrame` object.</span>

<span class="sd">        Args:</span>
<span class="sd">            input:</span>
<span class="sd">                Input data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ``BiocFrame`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`data` is not a polars `DataFrame` object.&quot;</span><span class="p">)</span>

        <span class="n">rdata</span> <span class="o">=</span> <span class="nb">input</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">as_series</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rdata</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.to_polars">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.to_polars">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;polars.DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the ``BiocFrame`` into a :py:class:`~polars.DataFrame` object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A :py:class:`~polars.DataFrame` object. Column names of the resulting</span>
<span class="sd">            dataframe may be different is the `BiocFrame` is nested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">_data_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">as_type</span><span class="o">=</span><span class="s2">&quot;dict&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">_data_copy</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{})</span></div>


    <span class="c1">###############################</span>
    <span class="c1">######&gt;&gt; Miscellaneous &lt;&lt;######</span>
    <span class="c1">###############################</span>

<div class="viewcode-block" id="BiocFrame.flatten">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.flatten">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">as_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;dict&quot;</span><span class="p">,</span> <span class="s2">&quot;biocframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dict&quot;</span><span class="p">,</span> <span class="n">delim</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">BiocFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flatten a nested BiocFrame object.</span>

<span class="sd">        Args:</span>
<span class="sd">            as_type:</span>
<span class="sd">                Return type of the result. Either a :py:class:`~dict` or a</span>
<span class="sd">                :py:class:`~biocframe.BiocFrame.BiocFrame` object.</span>

<span class="sd">            delim:</span>
<span class="sd">                Delimiter to join nested column names. Defaults to `&quot;.&quot;`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An object with the type specified by ``as_type`` argument.</span>
<span class="sd">            If ``as_type`` is `dict`, an additional column &quot;rownames&quot; is added if the object</span>
<span class="sd">            contains row names.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">as_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dict&quot;</span><span class="p">,</span> <span class="s2">&quot;biocframe&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;as_type&#39; must be either &#39;dict&#39; or &#39;biocframe&#39;.&quot;</span><span class="p">)</span>

        <span class="n">_data_copy</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()):</span>
            <span class="n">_cold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_cold</span><span class="p">,</span> <span class="n">BiocFrame</span><span class="p">):</span>
                <span class="n">_res</span> <span class="o">=</span> <span class="n">_cold</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">as_type</span><span class="o">=</span><span class="n">as_type</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">_res</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">_data_copy</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}{</span><span class="n">delim</span><span class="si">}{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_cold</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">Factor</span><span class="p">):</span>
                <span class="n">_data_copy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cold</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_data_copy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cold</span>

        <span class="k">if</span> <span class="n">as_type</span> <span class="o">==</span> <span class="s2">&quot;biocframe&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BiocFrame</span><span class="p">(</span><span class="n">_data_copy</span><span class="p">,</span> <span class="n">row_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_data_copy</span><span class="p">[</span><span class="s2">&quot;rownames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_names</span>

        <span class="k">return</span> <span class="n">_data_copy</span></div>


    <span class="c1"># TODO: very primitive implementation, needs very robust testing</span>
    <span class="c1"># TODO: implement in-place, view</span>
<div class="viewcode-block" id="BiocFrame.__array_ufunc__">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.__array_ufunc__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Interface for NumPy array methods.</span>

<span class="sd">        Note: This is a very primitive implementation and needs tests to support different types.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An object with the same type as the caller.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Not all NumPy array methods are fully tested.&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">Series</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pandas.api.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_numeric_dtype</span>

        <span class="nb">input</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">BiocFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input is not a `BiocFrame` object.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">Series</span><span class="p">(</span><span class="nb">input</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">))):</span>
                <span class="n">new_col</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="nb">input</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="nb">input</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_col</span>

        <span class="k">return</span> <span class="nb">input</span></div>


    <span class="c1">#############################</span>
    <span class="c1">######&gt;&gt; Combine Ops &lt;&lt;######</span>
    <span class="c1">#############################</span>

<div class="viewcode-block" id="BiocFrame.combine">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.combine">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:func:`~relaxed_combine_rows`, provided for back-compatibility only.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">relaxed_combine_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.relaxed_combine_rows">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.relaxed_combine_rows">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">relaxed_combine_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:func:`~relaxed_combine_rows`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">relaxed_combine_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.relaxed_combine_columns">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.relaxed_combine_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">relaxed_combine_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:func:`~relaxed_combine_columns`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">relaxed_combine_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.combine_rows">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.combine_rows">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">combine_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:func:`~biocutils.combine_rows`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_combine_rows_bframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.combine_columns">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.combine_columns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">combine_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:func:`~biocutils.combine_columns`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_combine_cols_bframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span><span class="p">)</span></div>


<div class="viewcode-block" id="BiocFrame.merge">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.BiocFrame.merge">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">other</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">,</span>
        <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">join</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;outer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">rename_duplicate_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:func:`merge`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">merge</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="p">),</span>
            <span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span>
            <span class="n">join</span><span class="o">=</span><span class="n">join</span><span class="p">,</span>
            <span class="n">rename_duplicate_columns</span><span class="o">=</span><span class="n">rename_duplicate_columns</span><span class="p">,</span>
        <span class="p">)</span></div>
</div>



<span class="c1">############################</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">combine_rows</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">BiocFrame</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_combine_rows_bframes</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combine multiple BiocFrame objects by row.</span>

<span class="sd">    Args:</span>
<span class="sd">        *x:</span>
<span class="sd">            One or more BiocFrame objects.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If all objects are not BiocFrame objects.</span>
<span class="sd">        ValueError:</span>
<span class="sd">            If all objects do not have the same number of columns.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new BiocFrame object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_list_of_type</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">BiocFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All objects to combine must be BiocFrame objects.&quot;</span><span class="p">)</span>

    <span class="n">first</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">total_nrows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">first_nc</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">has_rownames</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">total_nrows</span> <span class="o">+=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">_row_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">has_rownames</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">first_nc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;All objects to combine must have the same number of columns (expected &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">first_nc</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;, got &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="o">+</span> <span class="s2">&quot;).&quot;</span>
            <span class="p">)</span>

    <span class="n">new_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_column_names</span><span class="p">):</span>
        <span class="n">current</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">has_column</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;All objects to combine must have the same columns (missing &#39;&quot;</span>
                    <span class="o">+</span> <span class="n">col</span>
                    <span class="o">+</span> <span class="s2">&quot;&#39; in object &quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot;).&quot;</span>
                <span class="p">)</span>
            <span class="n">current</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
        <span class="n">new_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="o">*</span><span class="n">current</span><span class="p">)</span>

    <span class="n">new_rownames</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">has_rownames</span><span class="p">:</span>
        <span class="n">new_rownames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">other_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_row_names</span>
            <span class="k">if</span> <span class="n">other_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">other_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">new_rownames</span> <span class="o">+=</span> <span class="n">other_names</span>

    <span class="n">current_class_const</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">current_class_const</span><span class="p">(</span>
        <span class="n">new_data</span><span class="p">,</span>
        <span class="n">number_of_rows</span><span class="o">=</span><span class="n">total_nrows</span><span class="p">,</span>
        <span class="n">row_names</span><span class="o">=</span><span class="n">new_rownames</span><span class="p">,</span>
        <span class="n">column_names</span><span class="o">=</span><span class="n">first</span><span class="o">.</span><span class="n">_column_names</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">first</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span>
        <span class="n">column_data</span><span class="o">=</span><span class="n">first</span><span class="o">.</span><span class="n">_column_data</span><span class="p">,</span>
    <span class="p">)</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">combine_columns</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">BiocFrame</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_combine_cols_bframes</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combine multiple BiocFrame objects by column.</span>

<span class="sd">    Args:</span>
<span class="sd">        *x:</span>
<span class="sd">            One or more BiocFrame objects.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If all objects are not BiocFrame objects.</span>
<span class="sd">        ValueError:</span>
<span class="sd">            If all objects do not have the same number of rows or have duplicate columns.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new BiocFrame object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_list_of_type</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">BiocFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All objects to combine must be BiocFrame objects.&quot;</span><span class="p">)</span>

    <span class="n">first</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">first_nr</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">all_column_names</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">()</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">all_column_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">first_nr</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;All objects to combine must have the same number of rows (expected &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">first_nr</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;, got &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="o">+</span> <span class="s2">&quot;).&quot;</span>
            <span class="p">)</span>

        <span class="n">all_column_names</span> <span class="o">+=</span> <span class="n">df</span><span class="o">.</span><span class="n">_column_names</span>
        <span class="n">all_column_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_column_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">_column_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All objects to combine must have different columns (duplicated &#39;&quot;</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="s2">&quot;&#39;).&quot;</span><span class="p">)</span>
            <span class="n">all_data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="n">combined_column_data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">all_column_data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_column_data</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">all_column_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">BiocFrame</span><span class="p">({},</span> <span class="n">number_of_rows</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">combined_column_data</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">combine_rows</span><span class="p">(</span><span class="o">*</span><span class="n">all_column_data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Failed to combine &#39;column_data&#39; when combining &#39;BiocFrame&#39; objects by column. &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>

    <span class="n">current_class_const</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">current_class_const</span><span class="p">(</span>
        <span class="n">all_data</span><span class="p">,</span>
        <span class="n">number_of_rows</span><span class="o">=</span><span class="n">first_nr</span><span class="p">,</span>
        <span class="n">row_names</span><span class="o">=</span><span class="n">first</span><span class="o">.</span><span class="n">_row_names</span><span class="p">,</span>
        <span class="n">column_names</span><span class="o">=</span><span class="n">all_column_names</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">first</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span>
        <span class="n">column_data</span><span class="o">=</span><span class="n">combined_column_data</span><span class="p">,</span>
    <span class="p">)</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">extract_row_names</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">BiocFrame</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_rownames_bframe</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract row names from a BiocFrame object.</span>

<span class="sd">    Args:</span>
<span class="sd">        x:</span>
<span class="sd">            A BiocFrame object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Row names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">get_row_names</span><span class="p">()</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">extract_column_names</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">BiocFrame</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_colnames_bframe</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ut</span><span class="o">.</span><span class="n">Names</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract column names from a BiocFrame object.</span>

<span class="sd">    Args:</span>
<span class="sd">        x:</span>
<span class="sd">            A BiocFrame object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Column names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">show_as_cell</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">BiocFrame</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_show_as_cell_BiocFrame</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show a BiocFrame as a cell.</span>

<span class="sd">    Args:</span>
<span class="sd">        x:</span>
<span class="sd">            A BiocFrame object.</span>

<span class="sd">        indices:</span>
<span class="sd">            Indices to show.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">constructs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
        <span class="n">constructs</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">_column_names</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">show_as_cell</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">indices</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
            <span class="n">constructs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">constructs</span><span class="p">):</span>
        <span class="n">constructs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">constructs</span>


<span class="nd">@ut</span><span class="o">.</span><span class="n">assign_rows</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">BiocFrame</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_assign_rows_BiocFrame</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">replacement</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assign rows to a BiocFrame object.</span>

<span class="sd">    Args:</span>
<span class="sd">        x:</span>
<span class="sd">            A BiocFrame object.</span>

<span class="sd">        indices:</span>
<span class="sd">            Indices to assign.</span>

<span class="sd">        replacement:</span>
<span class="sd">            A BiocFrame object to assign.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new BiocFrame object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">set_slice</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">replacement</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">(),</span> <span class="n">replacement</span><span class="p">)</span>


<span class="c1">############################</span>


<span class="c1"># Could turn this into a generic, if it was more useful elsewhere.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_construct_missing</span><span class="p">(</span><span class="n">col</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a missing value for a column.</span>

<span class="sd">    Args:</span>
<span class="sd">        col:</span>
<span class="sd">            A column.</span>

<span class="sd">        n:</span>
<span class="sd">            Number of missing values to construct.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A missing value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">col</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
            <span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>


<div class="viewcode-block" id="relaxed_combine_rows">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.relaxed_combine_rows">[docs]</a>
<span class="nd">@ut</span><span class="o">.</span><span class="n">relaxed_combine_rows</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">BiocFrame</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">relaxed_combine_rows</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A relaxed version of the :py:func:`~biocutils.combine_rows.combine_rows` method for :py:class:`~BiocFrame`</span>
<span class="sd">    objects.  Whereas ``combine_rows`` expects that all objects have the same columns, ``relaxed_combine_rows`` allows</span>
<span class="sd">    for different columns. Absent columns in any object are filled in with appropriate placeholder values before</span>
<span class="sd">    combining.</span>

<span class="sd">    Args:</span>
<span class="sd">        x:</span>
<span class="sd">            One or more ``BiocFrame`` objects, possibly with differences in the</span>
<span class="sd">            number and identity of their columns.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A ``BiocFrame`` that combines all ``x`` along their rows and contains</span>
<span class="sd">        the union of all columns. Columns absent in any ``x`` are filled in</span>
<span class="sd">        with placeholders consisting of Nones or masked NumPy values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_list_of_type</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">BiocFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All objects to combine must be BiocFrame objects.&quot;</span><span class="p">)</span>

    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">first_occurrence</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">_column_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">first_occurrence</span><span class="p">:</span>
                <span class="n">new_colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
                <span class="n">first_occurrence</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

    <span class="c1"># Best attempt at creating a missing vector:</span>
    <span class="n">edited</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">extras</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">new_colnames</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">has_column</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
                <span class="n">extras</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">_construct_missing</span><span class="p">(</span>
                    <span class="n">first_occurrence</span><span class="p">[</span><span class="n">col</span><span class="p">],</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extras</span><span class="p">):</span>
            <span class="n">edited</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_columns</span><span class="p">(</span><span class="n">extras</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edited</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ut</span><span class="o">.</span><span class="n">combine_rows</span><span class="p">(</span><span class="o">*</span><span class="n">edited</span><span class="p">)</span></div>



<span class="c1">############################</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_normalize_merge_key_to_index</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">],</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalize a merge key to an index.</span>

<span class="sd">    Args:</span>
<span class="sd">        x:</span>
<span class="sd">            A sequence of BiocFrame objects.</span>

<span class="sd">        i:</span>
<span class="sd">            Index of the object in the sequence.</span>

<span class="sd">        by:</span>
<span class="sd">            A merge key.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError:</span>
<span class="sd">            If the merge key is invalid.</span>
<span class="sd">        TypeError:</span>
<span class="sd">            If the merge key is of an unknown type.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">by</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_row_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Row names required as key but are absent in object &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">by</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">nc</span> <span class="ow">or</span> <span class="n">by</span> <span class="o">&gt;=</span> <span class="n">nc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Integer &#39;by&#39; is out of range for object &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; columns).&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">by</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">by</span> <span class="o">+</span> <span class="n">nc</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">by</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ib</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_column_names</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ib</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No key column &#39;&quot;</span> <span class="o">+</span> <span class="n">by</span> <span class="o">+</span> <span class="s2">&quot;&#39; in object &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ib</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unknown type &#39;&quot;</span> <span class="o">+</span> <span class="nb">type</span><span class="p">(</span><span class="n">by</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;&#39; for the &#39;by&#39; argument.&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_merge_key</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">],</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a merge key.</span>

<span class="sd">    Args:</span>
<span class="sd">        x:</span>
<span class="sd">            A sequence of BiocFrame objects.</span>

<span class="sd">        i:</span>
<span class="sd">            Index of the object in the sequence.</span>

<span class="sd">        by:</span>
<span class="sd">            A list of merge keys.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A merge key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">by</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_row_names</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>


<div class="viewcode-block" id="merge">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.merge">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BiocFrame</span><span class="p">],</span>
    <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">join</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;outer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
    <span class="n">rename_duplicate_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge multiple :py:class:`~BiocFrame`` objects together by common columns or row names, yielding a combined</span>
<span class="sd">    object with a union of columns across all objects.</span>

<span class="sd">    Args:</span>
<span class="sd">        x:</span>
<span class="sd">            Sequence of ``BiocFrame`` objects. Each object may have any</span>
<span class="sd">            number and identity of rows and columns.</span>

<span class="sd">        by:</span>
<span class="sd">            If string, the name of column containing the keys. Each entry of</span>
<span class="sd">            ``x`` is assumed to have this column.</span>

<span class="sd">            If integer, the index of column containing the keys. The same</span>
<span class="sd">            index is used for each entry of ``x``.</span>

<span class="sd">            If None, keys are assumed to be present in the row names.</span>

<span class="sd">            Alternatively a sequence of strings, integers or None, specifying</span>
<span class="sd">            the location of the keys in each entry of ``x``.</span>

<span class="sd">        join:</span>
<span class="sd">            Strategy for the merge. For left and right joins, we consider the</span>
<span class="sd">            keys for the first and last object in ``x``, respectively.</span>

<span class="sd">        rename_duplicate_columns:</span>
<span class="sd">            Whether duplicated non-key columns across ``x`` should be</span>
<span class="sd">            automatically renamed in the merged object. If False, an error is</span>
<span class="sd">            raised instead.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A BiocFrame containing the merged contents.</span>

<span class="sd">        If ``by = None``, the keys are stored in the row names.</span>

<span class="sd">        If ``by`` is a string, keys are stored in the column of the same name.</span>

<span class="sd">        If ``by`` is a sequence, keys are stored in the row names if ``by[0] =</span>
<span class="sd">        None``, otherwise they are stored in the column named ``by[0]``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_list_of_type</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">BiocFrame</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All objects to merge must be BiocFrame objects.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">by</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">_normalize_merge_key_to_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">by</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">by</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;by&#39; list should have the same length as &#39;x&#39;.&quot;</span><span class="p">)</span>
        <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">_normalize_merge_key_to_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">by</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">join</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="n">_get_merge_key</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">by</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">join</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="n">_get_merge_key</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">by</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">join</span> <span class="o">==</span> <span class="s2">&quot;inner&quot;</span><span class="p">:</span>
        <span class="n">tmp_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">_get_merge_key</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">by</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="o">*</span><span class="n">tmp_keys</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">join</span> <span class="o">==</span> <span class="s2">&quot;outer&quot;</span><span class="p">:</span>
        <span class="n">tmp_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">_get_merge_key</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">by</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">tmp_keys</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown joining strategy &#39;&quot;</span> <span class="o">+</span> <span class="n">join</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>

    <span class="n">new_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">new_columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">raw_column_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">noop</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">join</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
            <span class="n">noop</span> <span class="o">=</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">join</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
            <span class="n">noop</span> <span class="o">=</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">keep</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">has_missing</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">reorg_keep</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">reorg_permute</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">noop</span><span class="p">:</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">all_keys</span><span class="p">,</span> <span class="n">_get_merge_key</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">by</span><span class="p">))</span>
            <span class="n">has_missing</span> <span class="o">=</span> <span class="p">(</span><span class="n">keep</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">has_missing</span><span class="p">:</span>
                <span class="n">non_missing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keep</span><span class="p">)</span> <span class="o">-</span> <span class="n">has_missing</span>
                <span class="n">reorg_keep</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">reorg_permute</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keep</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">reorg_permute</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">non_missing</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">reorg_permute</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reorg_keep</span><span class="p">))</span>
                        <span class="n">reorg_keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

        <span class="n">survivor_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_column_names</span><span class="p">):</span>
            <span class="n">on_key</span> <span class="o">=</span> <span class="n">by</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">j</span>
            <span class="k">if</span> <span class="n">on_key</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># skipping the key columns, except for the first.</span>
                <span class="k">continue</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
            <span class="n">survivor_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">rename_duplicate_columns</span><span class="p">:</span>
                <span class="n">original</span> <span class="o">=</span> <span class="n">y</span>
                <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">new_data</span><span class="p">:</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">original</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
            <span class="k">elif</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">new_data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Detected duplicate columns across objects to be merged (&#39;&quot;</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">&quot;&#39;).&quot;</span><span class="p">)</span>

            <span class="n">new_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">noop</span><span class="p">:</span>
                <span class="n">new_data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">on_key</span><span class="p">:</span>
                <span class="n">new_data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_keys</span>
            <span class="k">elif</span> <span class="n">has_missing</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">keep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Internal error: &#39;keep&#39; is None when has_missing == 0.&quot;</span><span class="p">)</span>
                <span class="n">new_data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">keep</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">reorg_keep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">reorg_permute</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Internal error: &#39;reorg_keep&#39; or &#39;reorg_permute&#39; is None when has_missing &gt; 0.&quot;</span><span class="p">)</span>
                <span class="n">retained</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">reorg_keep</span><span class="p">)</span>
                <span class="n">combined</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">retained</span><span class="p">,</span> <span class="n">_construct_missing</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">new_data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="n">combined</span><span class="p">,</span> <span class="n">reorg_permute</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">_column_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">raw_column_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">subset_rows</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">_column_data</span><span class="p">,</span> <span class="n">survivor_columns</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">raw_column_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">survivor_columns</span><span class="p">))</span>

    <span class="n">new_column_data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">raw_column_data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw_column_data</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">raw_column_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">BiocFrame</span><span class="p">({},</span> <span class="n">number_of_rows</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
        <span class="n">new_column_data</span> <span class="o">=</span> <span class="n">relaxed_combine_rows</span><span class="p">(</span><span class="o">*</span><span class="n">raw_column_data</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])(</span>
        <span class="n">new_data</span><span class="p">,</span>
        <span class="n">column_names</span><span class="o">=</span><span class="n">new_columns</span><span class="p">,</span>
        <span class="n">number_of_rows</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">get_height</span><span class="p">(</span><span class="n">all_keys</span><span class="p">),</span>
        <span class="n">column_data</span><span class="o">=</span><span class="n">new_column_data</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">by</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span><span class="o">.</span><span class="n">set_row_names</span><span class="p">(</span><span class="n">all_keys</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span></div>



<span class="c1">############################</span>


<div class="viewcode-block" id="relaxed_combine_columns">
<a class="viewcode-back" href="../../api/biocframe.html#biocframe.frame.relaxed_combine_columns">[docs]</a>
<span class="nd">@ut</span><span class="o">.</span><span class="n">relaxed_combine_columns</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">BiocFrame</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">relaxed_combine_columns</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="n">BiocFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiocFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper around :py:func:`~merge` that performs a left join on the row names.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">merge</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, jkanche
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=fe7df9b0"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>